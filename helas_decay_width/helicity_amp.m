(* ::Package:: *)

(* ::Input:: *)
(*Clear["Global`*"]*)


(* ::Input:: *)
(*Ide={{1,0,0,0},{0,1,0,0},{0,0,1,0},{0,0,0,1}};*)
(*G0={{0,0,1,0},{0,0,0,1},{1,0,0,0},{0,1,0,0}};*)
(*G1={{0,0,0,1},{0,0,1,0},{0,-1,0,0},{-1,0,0,0}};*)
(*G2={{0,0,0,-I},{0,0,I,0},{0,I,0,0},{-I,0,0,0}};*)
(*G3={{0,0,1,0},{0,0,0,-1},{-1,0,0,0},{0,1,0,0}};*)
(*G5={{-1,0,0,0},{0,-1,0,0},{0,0,1,0},{0,0,0,1}};*)
(*G={G0,I G1,I G2,I G3};*)
(*PL=(Ide-G5)/2;*)
(*PR=(Ide+G5)/2;*)
(*GSS[q_]:=G0 q[[1]]-G1 q[[2]]-G2 q[[3]]-G3 q[[4]];*)
(*SS[q_,p_]:=q[[1]]p[[1]]-q[[2]]p[[2]]-q[[3]]p[[3]]-q[[4]]p[[4]];*)
(*SIG[a_]:=If[a>=0,1,-1];*)
(*ABS2P[p_]:=Sqrt[p[[2]]^2+p[[3]]^2];*)
(*ABS3P[p_]:=Sqrt[p[[2]]^2+p[[3]]^2+p[[4]]^2];*)
(*(*Phup[p_]:=If[ABS2P[p]>0,Sqrt[(1+p[[2]]/ABS2P[p])/2]-I Sqrt[(1-p[[2]]/ABS2P[p])/2],1];*)
(*Phum[p_]:=If[ABS2P[p]>0,Sqrt[(1+p[[2]]/ABS2P[p])/2]+I Sqrt[(1-p[[2]]/ABS2P[p])/2],1];*)
(*Phv[p_]:=If[ABS2P[p]>0,p[[2]]/ABS2P[p]-I p[[3]]/ABS2P[p],1];*)*)
(*u[s_,p_]:=If[s>0,If[p[[4]]!=-ABS3P[p],1/Sqrt[2 ABS3P[p](ABS3P[p]+p[[4]])]{Sqrt[p[[1]]-ABS3P[p]](ABS3P[p]+p[[4]]),Sqrt[p[[1]]-ABS3P[p]](p[[2]]+I p[[3]]),Sqrt[p[[1]]+ABS3P[p]](ABS3P[p]+ p[[4]]),Sqrt[p[[1]]+ABS3P[p]](p[[2]]+I p[[3]])},{0,-Sqrt[p[[1]]-ABS3P[p]],0,-Sqrt[p[[1]]+ABS3P[p]]}],If[p[[4]]!=-ABS3P[p],1/Sqrt[2 ABS3P[p](ABS3P[p]+p[[4]])]{Sqrt[p[[1]]+ABS3P[p]](-p[[2]]+I p[[3]]),Sqrt[p[[1]]+ABS3P[p]](ABS3P[p]+p[[4]]),Sqrt[p[[1]]-ABS3P[p]](-p[[2]]+I p[[3]]),Sqrt[p[[1]]-ABS3P[p]](ABS3P[p]+p[[4]])},{Sqrt[p[[1]]+ABS3P[p]],0,Sqrt[p[[1]]-ABS3P[p]],0}]]*)
(*U[s_,p_]:=Conjugate[u[s,p]].G0*)
(*v[s_,p_]:=If[s>0,If[p[[4]]!=-ABS3P[p],1/Sqrt[2 ABS3P[p](ABS3P[p]+p[[4]])]{-Sqrt[p[[1]]+ABS3P[p]](-p[[2]]+I p[[3]]),-Sqrt[p[[1]]+ABS3P[p]](ABS3P[p]+p[[4]]),Sqrt[p[[1]]-ABS3P[p]](-p[[2]]+I p[[3]]),Sqrt[p[[1]]-ABS3P[p]](ABS3P[p]+p[[4]])},{-Sqrt[p[[1]]+ABS3P[p]],0,Sqrt[p[[1]]-ABS3P[p]],0}],If[p[[4]]!=-ABS3P[p],1/Sqrt[2 ABS3P[p](ABS3P[p]+p[[4]])]{Sqrt[p[[1]]-ABS3P[p]](ABS3P[p]+p[[4]]),Sqrt[p[[1]]-ABS3P[p]](p[[2]]+I p[[3]]),-Sqrt[p[[1]]+ABS3P[p]](ABS3P[p]+ p[[4]]),-Sqrt[p[[1]]+ABS3P[p]](p[[2]]+I p[[3]])},{0,-Sqrt[p[[1]]-ABS3P[p]],0,Sqrt[p[[1]]+ABS3P[p]]}]];*)
(*V[s_,p_]:=Conjugate[v[s,p]].G0*)
(*ep1[p_]:=If[ABS2P[p]>0,1/(ABS3P[p] ABS2P[p]){0,p[[2]]p[[4]],p[[3]]p[[4]],-ABS2P[p]^2},{0,1,0,0}];*)
(*ep2[p_]:=If[ABS2P[p]>0,1/ABS2P[p]{0,-p[[3]],p[[2]],0},{0,0,SIG[p[[4]]],0}];*)
(*ep[s_,p_]:=If[s>0,1/Sqrt[2](-ep1[p]-I ep2[p]),If[s<0,1/Sqrt[2](ep1[p]-I ep2[p]),p[[1]]/(Sqrt[p[[1]]^2-ABS3P[p]^2]ABS3P[p]){ABS3P[p]^2/p[[1]],p[[2]],p[[3]],p[[4]]}]];*)
(*beta[a_,b_]:=Sqrt[1+a^2+b^2-2(a+b+a b)];*)
(*mom[E_,m_,\[Theta]_,\[Phi]_]:={E,Sqrt[E^2-m^2]Sin[\[Theta]] Cos[\[Phi]],Sqrt[E^2-m^2]Sin[\[Theta]]Sin[\[Phi]],Sqrt[E^2-m^2]Cos[\[Theta]]}*)
(*mom2c[E_,m1_,m2_,\[Theta]_,\[Phi]_]:={mom[E/2(1+(m1^2-m2^2)/E^2),m1,\[Theta],\[Phi]],mom[E/2(1+(m2^2-m1^2)/E^2),m2,Pi-\[Theta],Pi+\[Phi]]}*)
(*mom22[E_,m1_,m2_,m3_,m4_,\[Theta]_,\[Phi]_]:={mom2c[E,m1,m2,0,0][[1]],mom2c[E,m1,m2,0,0][[2]],mom2c[E,m3,m4,\[Theta],\[Phi]][[1]],mom2c[E,m3,m4,\[Theta],\[Phi]][[2]]}*)


(* ::Text:: *)
(**)


(* ::Text:: *)
(*SuperPlus[e] SuperMinus[e] -> *)
(*\!\(\*OverscriptBox[*)
(*SubscriptBox[*)
(*SuperscriptBox[\(\[Chi]\), \(0\)], \(1\)], \(\[Tilde]\)]\) *)
(*\!\(\*OverscriptBox[\(G\), \(\[Tilde]\)]\)*)


(* ::Input:: *)
(*m1=0;*)
(*m2=0;*)
(*m3=Subscript[m, \[Chi]];*)
(*m4=0;*)
(*thet=\[Theta];*)
(*Phi=0;*)
(*rules={Sqrt[s]>Subscript[m, \[Chi]]>0,2\[Pi]>\[Theta]>0,1>Cos[\[Theta]]>-1,Cos[\[Theta]/2]>0,Sin[\[Theta]]>0,Sin[\[Theta]/2]>0,Csc[\[Theta]]>0,Csc[\[Theta]/2]>0,Cot[\[Theta]/2]>0,Sec[\[Theta]/2]>0};*)
(*p=Simplify[mom22[Sqrt[s],m1,m2,m3,m4,thet,Phi],rules];*)
(*p1=p[[1]]*)
(*p2=p[[2]]*)
(*p3=p[[3]]*)
(*p4=p[[4]]*)


(* ::Input:: *)
(*Mpl=(1.22089 10^19)/Sqrt[8\[Pi]];*)
(*mG=4.74 10^-9;*)
(*\[Alpha]em=1/127.934;*)
(*sN=1000^2;*)
(*\[Theta]N=ArcCos[0.9];*)
(*m\[Chi]N=139.236428;*)
(*meN=358.229154;*)
(*mz=91.1876;*)
(*(*\[CapitalGamma]z=2.41143316;*)*)
(*\[CapitalGamma]z=0;*)
(*mw=80.4079107;*)
(*N11=0.990612708;*)
(*N21=-0.0311086091;*)
(*sw=0.48332652203;*)


(* ::Input:: *)
(*cw=Sqrt[1-sw^2];*)
(*FN=Sqrt[3]Mpl mG;*)
(*eN=Sqrt[4\[Pi] \[Alpha]em];*)
(*C\[Gamma]=N11 cw+N21 sw;*)
(*Cz=-N11 sw+N21 cw;*)
(*gp=sw/cw;*)
(*gm=(-1+2sw^2)/(2sw cw);*)
(*CspN=C\[Gamma]-sN/(sN-mz^2+I mz \[CapitalGamma]z) gp Cz;*)
(*CsmN=C\[Gamma]-sN/(sN-mz^2+I mz \[CapitalGamma]z) gm Cz;*)
(*CepN=-N11/cw;*)
(*CemN=-(1/2) N21/sw-1/2 N11/cw;*)
(*q=p/.{s->sN,\[Theta]->ArcCos[1],Subscript[m, \[Chi]]->0};*)
(*tN=SS[q[[1]]-q[[3]],q[[1]]-q[[3]]];*)
(*uuN=SS[q[[1]]-q[[4]],q[[1]]-q[[4]]];*)


(* ::Input:: *)
(*\[Beta]=1-Subscript[m, \[Chi]]^2/s;*)
(*MMs[hel_,pp_]:=(e Subscript[m, \[Chi]])/(2Sqrt[2]F) 1/s ( V[hel[[2]],pp[[2]]].G0.(Csm PL+Csp PR).u[hel[[1]],pp[[1]]]U[hel[[3]],pp[[3]]].(GSS[pp[[3]]+pp[[4]]].G0-G0.GSS[pp[[3]]+pp[[4]]]).v[hel[[4]],pp[[4]]]-V[hel[[2]],pp[[2]]].G1.(Csm PL+Csp PR).u[hel[[1]],pp[[1]]]U[hel[[3]],pp[[3]]].(GSS[pp[[3]]+pp[[4]]].G1-G1.GSS[pp[[3]]+pp[[4]]]).v[hel[[4]],pp[[4]]]-V[hel[[2]],pp[[2]]].G2.(Csm PL+Csp PR).u[hel[[1]],pp[[1]]]U[hel[[3]],pp[[3]]].(GSS[pp[[3]]+pp[[4]]].G2-G2.GSS[pp[[3]]+pp[[4]]]).v[hel[[4]],pp[[4]]]-V[hel[[2]],pp[[2]]].G3.(Csm PL+Csp PR).u[hel[[1]],pp[[1]]]U[hel[[3]],pp[[3]]].(GSS[pp[[3]]+pp[[4]]].G3-G3.GSS[pp[[3]]+pp[[4]]]).v[hel[[4]],pp[[4]]])*)
(*MMt[hel_,pp_]:=(Sqrt[2]e Cep Subscript[m, e]^2)/F 1/(t-Subscript[m, e]^2) U[hel[[3]],pp[[3]]].PR.u[hel[[1]],pp[[1]]]V[hel[[2]],pp[[2]]].PL.v[hel[[4]],pp[[4]]]+(Sqrt[2]e Cem Subscript[m, e]^2)/F 1/(t-Subscript[m, e]^2) U[hel[[3]],pp[[3]]].PL.u[hel[[1]],pp[[1]]]V[hel[[2]],pp[[2]]].PR.v[hel[[4]],pp[[4]]]*)
(*MMu[hel_,pp_]:=(-Sqrt[2]e Cep Subscript[m, e]^2)/F 1/(uu-Subscript[m, e]^2) U[hel[[4]],pp[[4]]].PR.u[hel[[1]],pp[[1]]]V[hel[[2]],pp[[2]]].PL.v[hel[[3]],pp[[3]]]+(-Sqrt[2]e Cem Subscript[m, e]^2)/F 1/(uu-Subscript[m, e]^2) U[hel[[4]],pp[[4]]].PL.u[hel[[1]],pp[[1]]]V[hel[[2]],pp[[2]]].PR.v[hel[[3]],pp[[3]]]*)
(*Ms[hel_,pp_]:=Simplify[MMs[hel,pp],rules]*)
(*Mt[hel_,pp_]:=Simplify[-MMt[hel,pp],rules]*)
(*Mu[hel_,pp_]:=Simplify[MMu[hel,pp],rules]*)
(*iM[hel_,pp_]:={*)
(*Row[hel],*)
(*Simplify[Ms[hel,pp]/.{Cos[\[Theta]]->-2 Sin[\[Theta]/2]^2+1},rules]/.Sin[\[Theta]]->2Sin[\[Theta]/2]Cos[\[Theta]/2],*)
(*Simplify[Mt[hel,pp]/.{Cos[\[Theta]]->-2 Sin[\[Theta]/2]^2+1},rules],*)
(*Simplify[Mu[hel,pp]/.{Cos[\[Theta]]->-2 Sin[\[Theta]/2]^2+1},rules]/.Sin[\[Theta]]->2Sin[\[Theta]/2]Cos[\[Theta]/2]*)
(*}*)
(*M[hel_,pp_]:={*)
(*Row[hel],*)
(*Simplify[-I Ms[hel,pp]/.{Cos[\[Theta]]->-2 Sin[\[Theta]/2]^2+1},rules]/.Sin[\[Theta]]->2Sin[\[Theta]/2]Cos[\[Theta]/2],*)
(*Simplify[-I Mt[hel,pp]/.{Cos[\[Theta]]->-2 Sin[\[Theta]/2]^2+1},rules],*)
(*Simplify[-I Mu[hel,pp]/.{Cos[\[Theta]]->-2 Sin[\[Theta]/2]^2+1},rules]/.Sin[\[Theta]]->2Sin[\[Theta]/2]Cos[\[Theta]/2]*)
(*}*)
(*iMRed[hel_,pp_]:={*)
(*Row[hel],Simplify[Ms[hel,pp]/((-e Sqrt[\[Beta]] s)/(Sqrt[2]F))/.{Cos[\[Theta]]->-2 Sin[\[Theta]/2]^2+1},rules]/.Sin[\[Theta]]->2Sin[\[Theta]/2]Cos[\[Theta]/2],*)
(*Simplify[Mt[hel,pp]/((-e Sqrt[\[Beta]]s)/(Sqrt[2]F))/.{Cos[\[Theta]]->-2 Sin[\[Theta]/2]^2+1},rules],*)
(*Simplify[Mu[hel,pp]/((-e Sqrt[\[Beta]]s)/(Sqrt[2]F))/.{Cos[\[Theta]]->-2 Sin[\[Theta]/2]^2+1},rules]/.Sin[\[Theta]]->2Sin[\[Theta]/2]Cos[\[Theta]/2]*)
(*}*)
(*hel={{1,1,1,1},{1,1,1,-1},{1,1,-1,1},{1,1,-1,-1},{1,-1,1,1},{1,-1,1,-1},{1,-1,-1,1},{1,-1,-1,-1},{-1,1,1,1},{-1,1,1,-1},{-1,1,-1,1},{-1,1,-1,-1},{-1,-1,1,1},{-1,-1,1,-1},{-1,-1,-1,1},{-1,-1,-1,-1}};*)


(* ::Input:: *)
(*Grid[Prepend[iMRed[#,p]&/@hel,{"","Ms","Mt","Mu"}],Frame->All]*)
(*AA=M[#,p]&/@hel;*)


(* ::Input:: *)
(*Grid[Prepend[AA/.{s->sN,t->tN,uu->uuN,\[Theta]->\[Theta]N,Subscript[m, \[Chi]]->m\[Chi]N,Subscript[m, e]->meN,Csp->CspN,Csm->CsmN,Cep->CepN,Cem->CemN,F->FN,e->eN},{"","Ms","Mt","Mu"}],Frame->All]*)


(* ::Text:: *)
(**)


(* ::Text:: *)
(*SuperMinus[e] \[Gamma] -> *)
(*\!\(\*OverscriptBox[\(e\), \(\[Tilde]\)]\) *)
(*\!\(\*OverscriptBox[\(G\), \(\[Tilde]\)]\)*)


(* ::Input:: *)
(*m1=0;*)
(*m2=0;*)
(*m3=me;*)
(*m4=0;*)
(*thet=\[Theta];*)
(*Phi=0;*)
(*p=FullSimplify[mom22[Sqrt[s],m1,m2,m3,m4,thet,Phi],{1>Cos[\[Theta]]>-1,Sqrt[s]>me>0,Sin[\[Theta]]>0,Csc[\[Theta]]>0}];*)
(*p1=p[[1]]*)
(*p2=p[[2]]*)
(*p3=p[[3]]*)
(*p4=p[[4]]*)


(* ::Input:: *)
(*MMs[hel_]:=-e me^2/F/s U[hel[[4]],p4].PR.GSS[p1+p2].GSS[ep[hel[[2]],p2]].u[hel[[1]],p1]*)
(*MMt[hel_]:=e M/(2 F)/(t-M^2)U[hel[[4]],p4].(GSS[p2].GSS[ep[hel[[2]],p2]]-GSS[ep[hel[[2]],p2]].GSS[p2]).(GSS[p1-p3]+M Ide).PR.u[hel[[1]],p1]*)
(*MMu[hel_]:=-2e me^2/F/(uu-me^2)U[hel[[4]],p4].PR.u[hel[[1]],p1]SS[ep[hel[[2]],p2],p3]*)


(* ::Input:: *)
(*Ms[hel_]:=Simplify[MMs[hel],{1>Cos[\[Theta]]>-1,Sqrt[s]>me>0,s>me^2,Sin[\[Theta]]>0,Csc[\[Theta]]>0}]*)
(*Mt[hel_]:=Simplify[MMt[hel],{Pi>\[Theta]>0,1>Cos[\[Theta]]>-1,Sqrt[s]>me>0,s>me^2,Sin[\[Theta]]>0,Csc[\[Theta]]>0}]*)
(*Mu[hel_]:=Simplify[MMu[hel],{Pi>\[Theta]>0,1>Cos[\[Theta]]>-1,Sqrt[s]>me>0,s>me^2,Sin[\[Theta]]>0,Csc[\[Theta]]>0}]*)
(*M[hel_]:={Row[hel],Simplify[Ms[hel]/((-e Sqrt[1-me^2/s]s)/(Sqrt[2]F))/.{Cos[\[Theta]]->-2 Sin[\[Theta]/2]^2+1},{1>Cos[\[Theta]]>-1,Sqrt[s]>me>0,s>me^2,Sin[\[Theta]]>0,Csc[\[Theta]]>0,Csc[\[Theta]/2]>0,Sin[\[Theta]/2]>0}]/.Sin[\[Theta]]->2Sin[\[Theta]/2]Cos[\[Theta]/2],Simplify[Mt[hel]/((-e Sqrt[1-me^2/s]s)/(Sqrt[2]F))/.{Cos[\[Theta]]->-2 Sin[\[Theta]/2]^2+1},{1>Cos[\[Theta]]>-1,Sqrt[s]>me>0,s>me^2,Sin[\[Theta]]>0,Csc[\[Theta]]>0,Csc[\[Theta]/2]>0,Sin[\[Theta]/2]>0}],Simplify[Mu[hel]/((-e Sqrt[1-me^2/s]s)/(Sqrt[2]F))/.{Cos[\[Theta]]->-2 Sin[\[Theta]/2]^2+1},{1>Cos[\[Theta]]>-1,Sqrt[s]>me>0,s>me^2,Sin[\[Theta]]>0,Csc[\[Theta]]>0,Csc[\[Theta]/2]>0,Sin[\[Theta]/2]>0}]/.Sin[\[Theta]]->2Sin[\[Theta]/2]Cos[\[Theta]/2]}*)
(*hel={{1,1,0,1},{1,1,0,-1},{1,-1,0,1},{1,-1,0,-1},{-1,1,0,1},{-1,1,0,-1},{-1,-1,0,1},{-1,-1,0,-1}};*)


(* ::Input:: *)
(*Grid[Prepend[M/@hel,{"","Ms","Mt","Mu"}],Frame->All]*)
